name: ci/cd
on:
    pull_request:
        branches: [extrinsic]
        types: [reopened, opened, synchronize, ready_for_review, closed]

jobs:
    test:
        if: github.event.action != 'closed'
        permissions:
            contents: write
        uses: ./.github/workflows/commit.yml
        with:
            commit_message: test
        secrets: inherit

    deploy:
        if: github.event.action == 'closed' && github.event.pull_request.merged == true
        permissions:
            contents: write
        uses: ./.github/workflows/commit.yml
        with:
            commit_message: deploy
        secrets: inherit
